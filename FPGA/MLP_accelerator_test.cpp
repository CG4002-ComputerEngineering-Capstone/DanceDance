#include <stdio.h>

#define SIZE_INPUT 561
#define SIZE_OUTPUT 12

void accelerate_MLP(float input[SIZE_INPUT], float output[SIZE_OUTPUT]);

int main() {
	float input[SIZE_INPUT] = {0.0352,  0.0032, -0.0249, -0.9898, -0.9886, -0.9832, -0.9899, -0.9884,
						        -0.9840, -0.7945, -0.7412, -0.7143,  0.8342,  0.7139,  0.6694, -0.9873,
						        -0.9999, -0.9999, -0.9997, -0.9893, -0.9895, -0.9830, -0.6993, -0.4307,
						        -0.6040, -0.1228,  0.1558, -0.1098, -0.1547,  0.2438, -0.1922,  0.1546,
						        -0.0463,  0.0781,  0.0578, -0.0350, -0.1934,  0.0367, -0.6277, -0.4355,
						        -0.4319,  0.9593,  0.2223, -0.9844, -0.9822, -0.9815, -0.9854, -0.9817,
						        -0.9820, -0.4919,  0.9092,  0.2206, -0.3906,  0.9658,  0.2201, -0.4497,
						        -0.9981,  0.8420, -0.9073, -0.9871, -0.9816, -0.9846, -0.5317, -0.4323,
						        -0.4237, -0.9366,  0.9386, -0.9406,  0.9427, -0.8492,  0.8599, -0.8710,
						         0.8818, -0.5186,  0.5171, -0.5155,  0.5129, -0.2644, -0.3150, -0.8306,
						         0.0766,  0.0013, -0.0368, -0.9931, -0.9866, -0.9947, -0.9931, -0.9844,
						        -0.9957, -0.9930, -0.9903, -0.9912,  0.9917,  0.9913,  0.9872, -0.9937,
						        -0.9999, -0.9998, -0.9999, -0.9915, -0.9829, -0.9972, -0.7483, -0.7378,
						        -0.7973,  0.0188,  0.2384,  0.2021,  0.2913,  0.3217, -0.0269,  0.3312,
						         0.2163,  0.0747,  0.1837,  0.1859,  0.1454,  0.1321,  0.0013, -0.2877,
						        -0.0099, -0.0545,  0.0315, -0.9747, -0.9736, -0.9242, -0.9754, -0.9719,
						        -0.9211, -0.8905, -0.9564, -0.6624,  0.8516,  0.8763,  0.8406, -0.9201,
						        -0.9995, -0.9992, -0.9885, -0.9808, -0.9712, -0.9145,  0.0870, -0.7183,
						         0.5679,  0.1176, -0.1892,  0.0870,  0.0813, -0.1018, -0.0643,  0.0497,
						         0.3546,  0.0531, -0.1165,  0.0315,  0.1289, -0.3929,  0.9318, -0.1575,
						        -0.1144, -0.0284, -0.1119, -0.9916, -0.9951, -0.9959, -0.9922, -0.9953,
						        -0.9961, -0.9898, -0.9953, -0.9948,  0.9882,  0.9970,  0.9947, -0.9951,
						        -0.9999, -1.0000, -1.0000, -0.9925, -0.9954, -0.9964, -0.6672, -0.5814,
						        -0.7931,  0.1066,  0.0596, -0.1466,  0.3143, -0.0445, -0.0720, -0.1318,
						         0.2943,  0.2377, -0.2900,  0.3288, -0.2930,  0.0228,  0.1387, -0.1004,
						        -0.9874, -0.9894, -0.9915, -0.9830, -0.9968, -0.9874, -0.9998, -0.9937,
						        -0.5803,  0.0033,  0.0151,  0.1678, -0.2561, -0.9874, -0.9894, -0.9915,
						        -0.9830, -0.9968, -0.9874, -0.9998, -0.9937, -0.5803,  0.0033,  0.0151,
						         0.1678, -0.2561, -0.9941, -0.9944, -0.9949, -0.9916, -0.9799, -0.9941,
						        -0.9999, -0.9951, -0.8691,  0.2202, -0.2369, -0.3668,  0.3182, -0.9155,
						        -0.9156, -0.9089, -0.9412, -0.9584, -0.9155, -0.9957, -0.9218,  0.4277,
						        -0.1221, -0.1169, -0.0180,  0.4046, -0.9951, -0.9952, -0.9955, -0.9953,
						        -0.9906, -0.9951, -1.0000, -0.9960, -0.6766,  0.6115, -0.3879,  0.0148,
						        -0.2518, -0.9926, -0.9833, -0.9897, -0.9882, -0.9901, -0.9816, -0.9913,
						        -0.9858, -0.9855, -0.9864, -0.9893, -0.9777, -0.9998, -0.9986, -0.9987,
						        -0.9907, -0.9999, -0.9999, -0.9997, -0.9922, -0.9841, -0.9898, -0.9073,
						        -0.9449, -0.9442, -1.0000, -1.0000, -1.0000, -0.2049,  0.2307, -0.0713,
						         0.3546,  0.0899, -0.0985, -0.3447,  0.5067,  0.3679, -0.9999, -1.0000,
						        -0.9999, -0.9999, -0.9999, -0.9999, -1.0000, -1.0000, -0.9999, -0.9999,
						        -0.9999, -1.0000, -0.9999, -0.9999, -0.9999, -0.9999, -0.9998, -0.9997,
						        -0.9996, -0.9995, -0.9999, -0.9998, -0.9999, -0.9998, -0.9996, -0.9999,
						        -0.9999, -0.9997, -0.9997, -0.9999, -0.9999, -0.9999, -0.9998, -0.9999,
						        -0.9999, -1.0000, -0.9997, -0.9999, -0.9999, -0.9999, -0.9997, -0.9999,
						        -0.9936, -0.9869, -0.9944, -0.9931, -0.9872, -0.9928, -0.9909, -0.9868,
						        -0.9939, -0.9956, -0.9892, -0.9924, -0.9966, -0.9977, -0.9966, -0.9933,
						        -0.9999, -0.9998, -0.9999, -0.9901, -0.9875, -0.9932, -1.0000, -1.0000,
						        -1.0000, -0.3200,  0.1200, -0.4000,  0.0111,  0.1454,  0.0473, -0.5075,
						        -0.9047, -0.6450, -0.9218, -0.3986, -0.8020, -1.0000, -1.0000, -0.9999,
						        -0.9999, -0.9999, -0.9999, -1.0000, -1.0000, -1.0000, -0.9999, -0.9999,
						        -1.0000, -0.9999, -0.9999, -1.0000, -0.9999, -0.9998, -0.9997, -0.9997,
						        -0.9996, -0.9998, -1.0000, -0.9999, -0.9997, -0.9996, -0.9998, -0.9998, -0.9997, -0.9998, -0.9998, -0.9998, -0.9999, -0.9998, -0.9999, -0.9998,
						        -1.0000, -0.9998, -0.9999, -0.9998, -0.9998, -0.9999, -0.9999, -0.9722,
						        -0.9826, -0.9161, -0.9755, -0.9693, -0.9308, -0.9759, -0.9814, -0.9246,
						        -0.9732, -0.9657, -0.9270, -0.9794, -0.9852, -0.8558, -0.9627, -0.9996,
						        -0.9996, -0.9969, -0.9881, -0.9927, -0.9683, -0.6020, -0.6631, -0.3464,
						        -1.0000, -1.0000, -1.0000, -0.0737, -0.3196, -0.0541,  0.1145, -0.2066,
						         0.4304,  0.1682,  0.2534, -0.0507, -0.9996, -0.9999, -0.9999, -0.9999,
						        -0.9998, -0.9998, -0.9997, -0.9997, -0.9996, -0.9999, -0.9998, -0.9997,
						        -0.9996, -0.9998, -0.9994, -1.0000, -1.0000, -1.0000, -1.0000, -0.9999,
						        -0.9999, -0.9998, -0.9995, -1.0000, -1.0000, -0.9998, -0.9995, -1.0000,
						        -0.9971, -0.9996, -0.9996, -0.9994, -0.9991, -0.9979, -0.9949, -0.9940,
						        -0.9970, -0.9993, -0.9988, -0.9945, -0.9969, -0.9992, -0.9887, -0.9895,
						        -0.9855, -0.9910, -0.9961, -0.9887, -0.9999, -0.9878, -0.9070, -1.0000,
						         0.0385, -0.2504, -0.5414, -0.9948, -0.9928, -0.9910, -0.9965, -0.9926,
						        -0.9948, -0.9999, -0.9927, -1.0000, -0.8413,  0.2420, -0.5985, -0.9241,
						        -0.9403, -0.9148, -0.9324, -0.9093, -0.8904, -0.9403, -0.9962, -0.9704,
						        -0.3644, -1.0000, -0.1930,  0.2945,  0.0197, -0.9947, -0.9962, -0.9962,
						        -0.9964, -0.9984, -0.9947, -1.0000, -0.9963, -1.0000, -0.9683,  0.3823,
						        -0.5014, -0.7561, -0.3407,  0.7251,  0.0436, -0.0597,  0.5565, -0.8528,
						        -0.1313};

	float expected_output[SIZE_OUTPUT] = {-6.726093, -13.828334, -21.118219, 7.843160, -2.990144, 18.084270, -27.036345,
			-2.754830, -20.467728, 6.738018, -2.556483, 2.810406};

	float output[SIZE_OUTPUT] = {0};

	int i, j;

	accelerate_MLP(input, output);

	for (i = 0; i < SIZE_OUTPUT; i++) {
		printf("%f\n", output[i]);
	}

	// Compare output and expected output
	for (i = 0; i < SIZE_OUTPUT; i++) {
		float diff = expected_output[i] - output[i];
		// Output may not be exactly the same for floating point comparison
		if (diff > 0.01 || diff < -0.01) {
			printf("Fail\r\n");
			return 0;
		}
	}

	printf("Success\r\n");

	return 0;
}
